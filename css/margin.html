<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>理解margin重叠 | 技术分享</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.6c495ada.css" as="style"><link rel="preload" href="/assets/js/app.a5f12e3f.js" as="script"><link rel="preload" href="/assets/js/2.012767ec.js" as="script"><link rel="preload" href="/assets/js/4.c85e84b2.js" as="script"><link rel="prefetch" href="/assets/js/10.11845e8d.js"><link rel="prefetch" href="/assets/js/11.cda97d54.js"><link rel="prefetch" href="/assets/js/12.26a5fa04.js"><link rel="prefetch" href="/assets/js/13.e5412671.js"><link rel="prefetch" href="/assets/js/14.ce9d5328.js"><link rel="prefetch" href="/assets/js/15.36883b01.js"><link rel="prefetch" href="/assets/js/16.eab308d6.js"><link rel="prefetch" href="/assets/js/17.1bedb10d.js"><link rel="prefetch" href="/assets/js/18.86655160.js"><link rel="prefetch" href="/assets/js/19.3c121154.js"><link rel="prefetch" href="/assets/js/20.66014292.js"><link rel="prefetch" href="/assets/js/21.9b704246.js"><link rel="prefetch" href="/assets/js/22.79fb5d61.js"><link rel="prefetch" href="/assets/js/23.dd836561.js"><link rel="prefetch" href="/assets/js/24.b2cb9a0e.js"><link rel="prefetch" href="/assets/js/25.7ded2382.js"><link rel="prefetch" href="/assets/js/26.a858d3c2.js"><link rel="prefetch" href="/assets/js/27.6554e35b.js"><link rel="prefetch" href="/assets/js/28.dc59e70d.js"><link rel="prefetch" href="/assets/js/29.8ae6ac0b.js"><link rel="prefetch" href="/assets/js/3.91688b6b.js"><link rel="prefetch" href="/assets/js/30.158b3697.js"><link rel="prefetch" href="/assets/js/31.2617bdab.js"><link rel="prefetch" href="/assets/js/32.12fd8296.js"><link rel="prefetch" href="/assets/js/33.1fb3a562.js"><link rel="prefetch" href="/assets/js/34.861e72c8.js"><link rel="prefetch" href="/assets/js/35.9656c028.js"><link rel="prefetch" href="/assets/js/36.a8eff3ec.js"><link rel="prefetch" href="/assets/js/37.09f7437c.js"><link rel="prefetch" href="/assets/js/38.0bd7aae9.js"><link rel="prefetch" href="/assets/js/39.c309197e.js"><link rel="prefetch" href="/assets/js/40.78f76cb0.js"><link rel="prefetch" href="/assets/js/41.fd73aeb6.js"><link rel="prefetch" href="/assets/js/42.adcd28da.js"><link rel="prefetch" href="/assets/js/43.dad3d073.js"><link rel="prefetch" href="/assets/js/44.5ee75599.js"><link rel="prefetch" href="/assets/js/45.2c4ca62f.js"><link rel="prefetch" href="/assets/js/46.5cd263f5.js"><link rel="prefetch" href="/assets/js/47.e48a9193.js"><link rel="prefetch" href="/assets/js/5.0e5ac005.js"><link rel="prefetch" href="/assets/js/6.c4a7d53e.js"><link rel="prefetch" href="/assets/js/7.dbe0e90b.js"><link rel="prefetch" href="/assets/js/8.880eb801.js"><link rel="prefetch" href="/assets/js/9.5c5f6e8b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6c495ada.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">技术分享</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/" class="sidebar-link">技术分享这件小事</a><ul class="sidebar-sub-headers"></ul></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>css</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/css/center.html" class="sidebar-link">css居中调研</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/css/bfc.html" class="sidebar-link">bfc 学习</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/css/line-height.html" class="sidebar-link">理解 line-height</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/css/vertical-align.html" class="sidebar-link">vertical-align</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/css/stack-context.html" class="sidebar-link">层叠上下文</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/css/margin.html" class="active sidebar-link">理解margin重叠</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/css/cascade.html" class="sidebar-link">css层叠优先级(cascade)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/css/background.html" class="sidebar-link">深入理解background</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>common</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>design</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="理解margin重叠"><a href="#理解margin重叠" aria-hidden="true" class="header-anchor">#</a> 理解margin重叠</h1> <blockquote><p>学习计划开始第六天，今天的目标是理解margin重叠。之前学习bfc的时候，了解过一点margin重叠以及如何能避免的问题，以为对于margin重叠问题就够用了。没想到啊，随着任务进行的深入，才发现才不是这样呢！又有了一个新的认识。同时也把整个margin都了解了一遍呢。</p></blockquote> <h3 id="margin与元素尺寸以及相关布局"><a href="#margin与元素尺寸以及相关布局" aria-hidden="true" class="header-anchor">#</a> margin与元素尺寸以及相关布局</h3> <h4 id="元素尺寸"><a href="#元素尺寸" aria-hidden="true" class="header-anchor">#</a> 元素尺寸</h4> <blockquote><ul><li>元素尺寸: 包括padding 和border。offsetWidth/offsetHeight</li> <li>元素内部尺寸: 包括padding但不包括border，也就是元素的 padding box的尺寸。clientWidth/clientHeight</li> <li>元素外部尺寸: 不仅包括padding和 border，还包括margin。没有相对应的原生的DOM API。</li></ul></blockquote> <h4 id="margin与元素的内部尺寸"><a href="#margin与元素的内部尺寸" aria-hidden="true" class="header-anchor">#</a> margin与元素的内部尺寸</h4> <blockquote><p>元素设定了width值或者保持“包裹性”的时候，margin对尺寸没有影响，只有元素是<code>“充分利用可用空间”</code>状态的时候，margin才可以改变元素的可视尺寸。
元素宽度还是300px</p></blockquote> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.father</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0 -20px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>元素宽度是340px, 因为此时宽度表现是&quot;充分可利用空间&quot;，所以通过负值设置变大了。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.father</span> <span class="token punctuation">{</span> <span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token selector">.son</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> 0 -20px<span class="token punctuation">;</span> <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>father<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>son<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>css默认的流方向是水平方向，对于普通流体元素，margin只能改变元素水平方向尺寸；对于具有拉伸特性的绝对定位元素，则水平或垂直方向都可以，因为此时的尺寸表现符合“充分利用可用空间”。由于margin具有这种流体特性下的改变尺寸特性。margin可以很方便地 实现很多流体布局效果。</p></blockquote> <p><a href="http://demo.cssworld.cn/4/3-1.php" target="_blank" rel="noopener noreferrer">两栏自适应布局效果演示<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>还可以利用margin改变元素尺寸来实现两端对齐布局效果.</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* 此时ul的宽度相当于100%+20px */</span>
<span class="token selector">ul</span> <span class="token punctuation">{</span> <span class="token property">margin-right</span><span class="token punctuation">:</span> -20px<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">ul &gt; li</span> <span class="token punctuation">{</span>
  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span> 
  <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span> 
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="margin与元素的外部尺寸"><a href="#margin与元素的外部尺寸" aria-hidden="true" class="header-anchor">#</a> margin与元素的外部尺寸</h4> <blockquote><p>对于外部尺寸，margin属性的影响则更为广泛，只要元素具有块状特性，无论有没有设置width/height，无论是水平方向还是垂直方向，即使发生了margin合并，margin对外部尺寸都着着实实发生了影响。</p></blockquote> <p><code>利用margin外部尺寸实现等高布局</code>, 还可以利用display:table-cell布局等。
<a href="http://demo.cssworld.cn/4/3-2.php" target="_blank" rel="noopener noreferrer">演示<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.column-box</span> <span class="token punctuation">{</span>
  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.column-left,
.column-right</span> <span class="token punctuation">{</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> -9999px<span class="token punctuation">;</span>
  <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 9999px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注意: 上述margin对尺寸的影响是针对具有块状特性的元素而言的，对于纯内联元素 则不适用。内联元素垂直方向的margin是没有任何影响的，既不会影响外部尺寸，也不会影响内部尺寸。对于水平方向，由于内联元素宽度表现为“包裹性”，也不会影响内部尺寸。</p> <h3 id="margin的百分比"><a href="#margin的百分比" aria-hidden="true" class="header-anchor">#</a> margin的百分比</h3> <blockquote><p>和padding属性一样，margin的百分比值无论是水平方向还是垂直方向都是相对于宽度计算的。不过相对于padding，margin的百分比值的应用价值就低了一截，根本原因在于和padding不同，元素设置margin在垂直方向上无法改变元素自身的内部尺寸，往往需要父元素作为载体。同时由于margin合并的存在等。</p></blockquote> <h3 id="正确看待css世界里的margin合并"><a href="#正确看待css世界里的margin合并" aria-hidden="true" class="header-anchor">#</a> 正确看待CSS世界里的margin合并</h3> <h4 id="什么是margin合并"><a href="#什么是margin合并" aria-hidden="true" class="header-anchor">#</a> 什么是margin合并</h4> <blockquote><p>块级元素的上外边距(margin-top)与下外边距(margin-bottom)有时会合并为单个外边距，这样的现象称为“margin合并”。</p></blockquote> <ul><li><code>块级元素</code>，但不包括浮动和绝对定位元素，尽管浮动和绝对定位可以让元素块状化。</li> <li>只发生在垂直方向，<code>需要注意的是，这种说法在不考虑writing-mode的情况下才是正确的，严格来讲，应该是只发生在和当前文档流方向的相垂直的方向上。由于默认文档流是水平流，因此发生margin合并的就是垂直方向</code>。</li></ul> <h4 id="margin合并的3种场景"><a href="#margin合并的3种场景" aria-hidden="true" class="header-anchor">#</a> margin合并的3种场景</h4> <ul><li>相邻兄弟元素margin合并</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">p</span> <span class="token punctuation">{</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 1em 0<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>第一行<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>第二行<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>想阻止合并的话，可以将其中一个设置为浮动，定位，行内等。</p> <div class="margin-main"><p>第一行</p> <p>第二行</p></div> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.line2</span> <span class="token punctuation">{</span>
  <span class="token comment">/* float: left; */</span>
  <span class="token comment">/* position: absolute; */</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="margin-main"><p>第一行</p> <p class="line2">第二行</p></div> <ul><li>父级和第一个/最后一个子元素, 下面三种效果等效, getComputedStyle获取到的margin值还是原来设置的margin值.</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>father<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>    
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>son<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">margin-top</span><span class="token punctuation">:</span>80px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>father<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">margin-top</span><span class="token punctuation">:</span>80px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>    
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>son<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>father<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">margin-top</span><span class="token punctuation">:</span>80px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>    
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>son<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">margin-top</span><span class="token punctuation">:</span>80px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>如何阻止marign合并呢？
对于margin-top合并，可以进行如下操作(满足一个条件即可)</p> <blockquote><ul><li>父元素设置为块状格式化上下文元素;</li> <li>父元素设置border-top值;</li> <li>父元素设置padding-top值;</li> <li>父元素和第一个子元素之间添加内联元素进行分隔。</li></ul></blockquote> <p>对于margin-bottom合并，可以进行如下操作(满足一个条件即可)</p> <blockquote><ul><li>父元素设置为块状格式化上下文元素;</li> <li>父元素设置border-bottom值;</li> <li>父元素设置padding-bottom值;</li> <li>父元素和最后一个子元素之间添加内联元素进行分隔;</li> <li>父元素设置height、min-height或max-height。</li></ul></blockquote> <ul><li>空块级元素的margin合并。(实际中这种情况比较少见)</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.father</span> <span class="token punctuation">{</span> <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token selector">.son</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> 1em 0<span class="token punctuation">;</span> <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>father<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>son<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>想阻止合并，可以进行如下操作(满足一个条件即可)</p> <blockquote><ul><li>设置垂直方向的border;</li> <li>设置垂直方向的padding;</li> <li>里面添加内联元素(直接空格是没用的);</li> <li>设置height或者min-height。</li></ul></blockquote> <p><code>margin合并演示</code></p><style>
.margin-test div {
margin: 2rem 0;
background: lavender;
}
.margin-test p {
margin: .4rem 0 1.2rem 0;
background: yellow;
}
</style> <div class="margin-test"><p>The bottom margin of this paragraph is collapsed …</p> <p>… with the top margin of this paragraph, yielding a margin of <code>1.2rem</code> in between.</p><p></p> <div>This parent element contains two paragraphs!
    <p>This paragraph has a <code>.4rem</code> margin between it and the text above.</p> <p>My bottom margin collapses with my parent, yielding a bottom margin of <code>2rem</code>.</p></div> <p>I am <code>2rem</code> below the element above.</p></div> <h4 id="margin合并的计算规则"><a href="#margin合并的计算规则" aria-hidden="true" class="header-anchor">#</a> margin合并的计算规则</h4> <blockquote><p>“正正取大值”“正负值相加”“负负最负值”。针对三种情况都适用。</p></blockquote> <h4 id="margin合并的意义"><a href="#margin合并的意义" aria-hidden="true" class="header-anchor">#</a> margin合并的意义</h4> <blockquote><p>故意这么设计的，在实际内容呈现的时候是有着重要意义的，根本就不是bug。</p></blockquote> <ul><li>对于兄弟元素的margin合并其作用和em类似，都是让图文信息的排版更加舒服自然。</li> <li>父子margin合并的意义在于:在页面中任何地方嵌套或直接放入任何裸div, 都不会影响原来的块状布局。</li> <li>自身margin合并的意义在于可以避免不小心遗落或者生成的空标签影响排版和布局。</li></ul> <h3 id="深入理解css中的margin-auto"><a href="#深入理解css中的margin-auto" aria-hidden="true" class="header-anchor">#</a> 深入理解CSS中的margin:auto</h3> <p>我们要知道以下事实。</p> <ul><li>有时候元素就算没有设置width或height，也会自动填充。</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 此&lt;div&gt;宽度就会自动填满容器。 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>有时候元素就算没有设置width或height，也会自动填充对应的方位。</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* 此时&lt;div&gt;宽度就会自动填满包含块容器。 */</span>
<span class="token selector">div</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 如果设置width或height，自动填充特性就会被覆盖。*/</span>
<span class="token comment">/* 假设外部的容器宽度是300px，则有100px的宽度原本应该自动填满的，现在因为width设置而闲置，而margin:auto就是为了填充这个闲置的尺寸而设计的! */</span>
<span class="token selector">div</span> <span class="token punctuation">{</span> <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><p>margin:auto的填充规则如下。
CSS世界中margin的初始值大小是0。</p> <ul><li>如果一侧定值，一侧auto，则auto为剩余空间大小。</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.father</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #f0f3f9<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.son</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
    <span class="token property">margin-right</span><span class="token punctuation">:</span> 80px<span class="token punctuation">;</span> 
    <span class="token property">margin-left</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span> <span class="token comment">/* 20px */</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #cd0000<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>father<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>son<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="father"><div class="son"></div></div> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.son2</span> <span class="token punctuation">{</span>
    <span class="token comment">/* margin-right缺失 可以实现右对齐效果 */</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span> 
    <span class="token property">height</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
    <span class="token property">margin-left</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span> 
    <span class="token property">background-color</span><span class="token punctuation">:</span> #cd0000<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>father<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>son2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="father"><div class="son2"></div></div> <ul><li>如果两侧均是auto，则平分剩余空间。</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.son</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span> 
  <span class="token property">margin-left</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>注意</code>: 触发margin:auto计算有一个前提条件，就是width或height为auto时，元素是具有对应方向的自动填充特性的。例如最开始介绍的必须知道的事实。</p> <blockquote><p>那么如何实现垂直方向的垂直居中?</p></blockquote> <ul><li>使用writing-mode改变文档流的方向</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.father</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
  <span class="token property">writing-mode</span><span class="token punctuation">:</span> vertical-lr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.son</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>让水平垂直同时居中。(之前文章也介绍过这种水平垂直居中的方法)</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.father</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span> 
  <span class="token property">height</span><span class="token punctuation">:</span>150px<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.son</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> 
  <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>补充说明:</p> <blockquote><p>如果里面元素尺寸大，说明剩余可用空间都没有了，会被当作0来处理，也就是auto会被计算成0。相当于没有设置margin值，因为初始值为0。对于替换元素，如果我们设置display:block，则margin:auto的计算规则同样适合。</p></blockquote> <h3 id="margin无效情形解析"><a href="#margin无效情形解析" aria-hidden="true" class="header-anchor">#</a> margin无效情形解析</h3> <ul><li>display计算值inline的非替换元素的垂直margin是无效的。对于内联替换元素，垂直margin有效，并且没有margin合并的问题，所以图片永远不会发生margin合并。</li> <li>表格中的tr和td元素或者设置display计算值是table-cell或table-row的元素的margin都是无效的。</li> <li>margin合并的时候，更改margin值可能是没有效果的。根据margin合并计算规则。</li> <li>绝对定位元素非定位方位的margin值“无效”。</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">img</span> <span class="token punctuation">{</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 10%<span class="token punctuation">;</span> 
  <span class="token property">left</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span> 
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span> <span class="token comment">/* 相当于没设置。因为right和bottom值属于auto状态，所以在这两个方向设置对应margin看不到效果。 但是实际上渲染了。只不过绝对定位元素独立渲染，不影响兄弟元素定位。*/</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>定高容器的子元素的margin-bottom或者宽度定死的子元素的margin- right的定位“失效”。</li> <li>鞭长莫及导致的margin无效。(与bfc特性有关)</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.box &gt; img</span> <span class="token punctuation">{</span> 
    <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 256px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.box &gt; p</span> <span class="token punctuation">{</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span> 
    <span class="token property">margin-left</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mm1.jpg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>内联特性导致的margin无效。(vertical-align和内联盒模型导致的,前面文章有介绍过)</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.box &gt; img</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 96px<span class="token punctuation">;</span> 
    <span class="token property">margin-top</span><span class="token punctuation">:</span> -200px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mm1.jpg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="参考"><a href="#参考" aria-hidden="true" class="header-anchor">#</a> 参考</h4> <ul><li>css世界</li> <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Box_Model/Mastering_margin_collapsing" target="_blank" rel="noopener noreferrer">外边距重叠<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/css/stack-context.html" class="prev">
          层叠上下文
        </a></span> <span class="next"><a href="/css/cascade.html">
          css层叠优先级(cascade)
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a5f12e3f.js" defer></script><script src="/assets/js/2.012767ec.js" defer></script><script src="/assets/js/4.c85e84b2.js" defer></script>
  </body>
</html>

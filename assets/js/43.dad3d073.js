(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{257:function(t,a,s){"use strict";s.r(a);var e=s(0),r=Object(e.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"线上环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#线上环境","aria-hidden":"true"}},[t._v("#")]),t._v(" 线上环境")]),t._v(" "),s("ul",[s("li",[t._v("服务器稳定性")]),t._v(" "),s("li",[t._v("充分利用服务器硬件资源，以便提高性能")]),t._v(" "),s("li",[t._v("线上日志记录")])]),t._v(" "),s("h3",{attrs:{id:"pm2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pm2","aria-hidden":"true"}},[t._v("#")]),t._v(" pm2")]),t._v(" "),s("ul",[s("li",[t._v("进程守护，系统崩溃自动重启")]),t._v(" "),s("li",[t._v("启动多进程，充分利用CPU和内存")]),t._v(" "),s("li",[t._v("自带日志记录功能")])]),t._v(" "),s("h3",{attrs:{id:"常用命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常用命令","aria-hidden":"true"}},[t._v("#")]),t._v(" 常用命令")]),t._v(" "),s("p",[t._v("包括 list restart stop delete info log monit")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("pm2 start ..., pm2 list\npm2 stop app\npm2 delete pm2-test-server\npm2 restart <AppName>/<id>\npm2 info app\npm2 log app\npm2 monit\n")])])]),s("h3",{attrs:{id:"进程守护"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#进程守护","aria-hidden":"true"}},[t._v("#")]),t._v(" 进程守护")]),t._v(" "),s("ul",[s("li",[t._v("node app.js 和 nodemon app.js, 进程崩溃则不能访问")]),t._v(" "),s("li",[t._v("pm2 遇到进程崩溃，会自动重启")])]),t._v(" "),s("h3",{attrs:{id:"配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置")]),t._v(" "),s("ul",[s("li",[t._v("新建PM2配置文件(包括进程数量，日志文件目录等) json格式的")]),t._v(" "),s("li",[t._v("修改PM2启动命令，重启")]),t._v(" "),s("li",[t._v("访问server, 检查日志文件的内容(日志记录是否生效)")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('// pm2.conf.json\n{\n  "apps" : {\n    "name": "pm2-test-server",\n    "script": "app.js",\n    "watch": true,\n    "ignore_watch": [\n      "node_modules",\n      "logs"\n    ],\n    "instances": 4,// 设置多进程的\n    "error_file": "logs/err.log",\n    "out_file": "logs/out.log",\n    "log_date_format": "YYYY-MM-DD HH:mm:ss"\n  }\n}\n// package.json\n{\n  "scripts": {\n    "prd": "cross-env NODE_ENV=production pm2 start pm2.conf.json"\n  }\n}\n')])])]),s("h3",{attrs:{id:"为何使用多进程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为何使用多进程","aria-hidden":"true"}},[t._v("#")]),t._v(" 为何使用多进程")]),t._v(" "),s("ul",[s("li",[t._v("操作系统限制一个进程的内存")]),t._v(" "),s("li",[t._v("内存：无法充分利用机器全部内存")]),t._v(" "),s("li",[t._v("CPU: 无法充分利用多核CPU的优势")])]),t._v(" "),s("h3",{attrs:{id:"多进程和redis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多进程和redis","aria-hidden":"true"}},[t._v("#")]),t._v(" 多进程和redis")]),t._v(" "),s("ul",[s("li",[t._v("多进程之间，内存无法共享")]),t._v(" "),s("li",[t._v("多进程访问一个redis,实现数据共享.")])])])},[],!1,null,null,null);a.default=r.exports}}]);